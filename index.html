<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Wiki Race: Synchronized</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Arial', sans-serif; background: #111; color: white; overflow: hidden; }
        
        /* Start Screen */
        #start-screen {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('background.jpg');
            background-size: cover; height: 100vh; display: flex; justify-content: center; align-items: center;
        }

        /* Top Navigation Bar */
        #game-header {
            display: none; background: #222; height: 70px; border-bottom: 2px solid #f1c40f;
            display: none; align-items: center; justify-content: space-between; padding: 0 20px;
        }

        .target-box { position: relative; text-align: center; border: 1px solid #444; padding: 5px 15px; border-radius: 8px; cursor: help; }
        .target-title { color: #f1c40f; font-weight: bold; font-size: 1.1rem; }
        
        /* Tooltip Description */
        .tooltip {
            visibility: hidden; width: 280px; background: #333; color: #fff; border: 1px solid #f1c40f;
            padding: 10px; position: absolute; top: 110%; left: 50%; transform: translateX(-50%);
            z-index: 100; border-radius: 5px; font-size: 0.85rem; text-align: left; opacity: 0; transition: 0.3s;
        }
        .target-box:hover .tooltip { visibility: visible; opacity: 1; }

        /* Stats Display */
        .stat-item { margin: 0 10px; font-family: monospace; color: #aaa; }
        .stat-item b { color: #fff; }

        /* Game Area */
        #iframe-container { width: 100%; height: calc(100vh - 130px); background: white; }
        iframe { width: 100%; height: 100%; border: none; }

        /* Bottom Controls */
        .bottom-bar { height: 60px; background: #222; display: flex; justify-content: center; align-items: center; }
        #win-btn { 
            padding: 10px 30px; border-radius: 25px; border: none; font-weight: bold;
            background: #555; color: #888; cursor: not-allowed; transition: 0.3s;
        }
        #win-btn.active { background: #27ae60; color: white; cursor: pointer; box-shadow: 0 0 20px rgba(39, 174, 96, 0.5); }

        .menu-card { background: rgba(0,0,0,0.9); padding: 40px; border-radius: 20px; border: 1px solid #333; text-align: center; }
        input { padding: 10px; width: 200px; border-radius: 5px; border: none; margin: 10px 0; }
    </style>
</head>
<body>

    <div id="start-screen">
        <div class="menu-card">
            <h1>BIZ WIKI RACE</h1>
            <p>Enter Seed ID to Sync with Partner:</p>
            <input type="number" id="seed-input" placeholder="e.g. 1234">
            <br>
            <button onclick="startGame()" style="background:#f1c40f; padding: 10px 40px; font-weight:bold; border-radius:5px; border:none; cursor:pointer;">START MATCH</button>
        </div>
    </div>

    <div id="game-header">
        <div class="stats">
            <span class="stat-item">‚è±Ô∏è <b id="timer">0s</b></span>
            <span class="stat-item">üñ±Ô∏è <b id="clicks">0</b></span>
            <span class="stat-item">üîô <b id="backs">0</b></span>
        </div>

        <div class="target-box">
            GOAL: <span class="target-title" id="target-display">---</span>
            <div class="tooltip" id="target-desc">Hover to reveal target details...</div>
        </div>

        <button onclick="location.reload()" style="background:none; border:1px solid #555; color:white; cursor:pointer; padding:5px 10px; border-radius:4px;">RESTART</button>
    </div>

    <div id="iframe-container" style="display:none;">
        <iframe id="wiki-frame" src=""></iframe>
    </div>

    <div id="bottom-bar" class="bottom-bar" style="display:none;">
        <button id="win-btn" onclick="checkVictory()">üèÅ I REACHED THE TARGET</button>
    </div>

    <script>
        let clickCount = 0;
        let backCount = 0;
        let startTime;
        let targetTitle = "";

        const articlePool = [
            {t: "Apple Inc.", d: "The company that created the iPhone and Mac."},
            {t: "Elon Musk", d: "Founder of SpaceX and CEO of Tesla."},
            {t: "Bitcoin", d: "The world's first decentralized digital currency."},
            {t: "Silicon Valley", d: "The global hub of technological innovation in California."},
            {t: "Stock market", d: "The place where shares of public companies are traded."},
            {t: "Fortune 500", d: "The list of the most successful companies in the USA."},
            {t: "Artificial intelligence", d: "Intelligence demonstrated by machines, unlike natural intelligence."}
        ];

        function startGame() {
            const seed = parseInt(document.getElementById('seed-input').value);
            if (!seed) { alert("Please enter a Seed ID first!"); return; }

            // Deterministic selection based on Seed
            const startIdx = seed % articlePool.length;
            const targetIdx = (seed + 2) % articlePool.length; // Ensure target is different from start

            const startPage = articlePool[startIdx].t;
            targetTitle = articlePool[targetIdx].t;
            const targetDesc = articlePool[targetIdx].d;

            // UI Update
            document.getElementById('target-display').innerText = targetTitle;
            document.getElementById('target-desc').innerText = targetDesc;
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('game-header').style.display = 'flex';
            document.getElementById('iframe-container').style.display = 'block';
            document.getElementById('bottom-bar').style.display = 'flex';

            // Load Start Page
            const frame = document.getElementById('wiki-frame');
            frame.src = `https://en.m.wikipedia.org/wiki/${startPage.replace(/ /g, '_')}`;

            startTime = Date.now();
            
            // Background Monitor
            setInterval(updateGameStatus, 1000);
            
            // Listen for clicks (frame reloads)
            frame.onload = () => {
                clickCount++;
                document.getElementById('clicks').innerText = clickCount;
            };
        }

        function updateGameStatus() {
            const now = Date.now();
            document.getElementById('timer').innerText = Math.floor((now - startTime) / 1000) + "s";

            // Security: Auto-enable button only if the Wikipedia title matches target
            const frame = document.getElementById('wiki-frame');
            try {
                // We check the 'src' which changes as the user clicks links
                if (frame.src.toLowerCase().includes(targetTitle.replace(/ /g, '_').toLowerCase())) {
                    document.getElementById('win-btn').classList.add('active');
                }
            } catch(e) { 
                // Fallback for security restrictions: enable button anyway so player can try to claim win
                document.getElementById('win-btn').classList.add('active');
            }
        }

        function checkVictory() {
            if (!document.getElementById('win-btn').classList.contains('active')) {
                alert("You aren't at the goal yet! Keep clicking.");
                return;
            }

            const totalTime = document.getElementById('timer').innerText;
            alert(`üèÜ VICTORY!\n\nSeed used: ${document.getElementById('seed-input').value}\nTime: ${totalTime}\nClicks: ${clickCount}\nBack-Button Uses: ${backCount}`);
            location.reload();
        }

        // Detect Browser Back Button
        window.addEventListener('popstate', () => {
            backCount++;
            document.getElementById('backs').innerText = backCount;
        });
    </script>
</body>
</html>
